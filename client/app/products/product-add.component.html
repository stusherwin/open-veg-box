<div class="row add-mode" #active=cc-active cc-active [class.focused]="rowFocused" (activate)="onActivate()" (deactivate)="onDeactivate()">
  <div class="actions">
    <div class="action" [hidden]="adding || !loaded">
      <button #add cc-active cc-activate-on-focus cc-deactivate-on-blur (click)="startAdd()" [tabindex]="(tabindex * 2) + 2">
        <div class="icon"><i class="icon-add"></i></div>
        <span>Add</span>
      </button>  
    </div>
    <div class="action" *ngIf="adding">
      <button cc-active cc-activate-on-focus (click)="completeAdd()" [tabindex]="(tabindex * 2) + 2">
        <div class="icon"><i class="icon-ok"></i></div>
        <span>Save</span>
      </button>  
    </div>
    <div class="action" *ngIf="adding">
      <button cc-active cc-activate-on-focus (click)="cancelAdd()" [tabindex]="(tabindex * 2) + 2">
        <div class="icon"><i class="icon-cancel"></i></div>
        <span>Cancel</span>
      </button>  
    </div>
  </div>
  <p *ngIf="loaded && showAddMessage && !adding">There are no products yet.</p>
  <p *ngIf="!loaded"><i class="icon-spin3 animate-spin"></i> Loading products...</p>
  <div class="details product-add" [hidden]="!adding" [class.invalid]="!valid">
    <div class="product-name">
      <cc-validatable [valid]="!!product.name.length" message="Name should not be empty">
        <input #productName placeholder="New Product" type="text" [(ngModel)]="product.name" [tabindex]="(tabindex * 2) + 1" cc-active cc-activate-on-focus />
      </cc-validatable>
    </div>
    <div style="margin: 5px 0">
      &pound;
      <cc-validatable [valid]="product.price > 0" message="Price should be a number greater than 0">
        <input type="text" #input class="input price" cc-numeric fixedDecimals="2" [(value)]="product.price" [tabindex]="(tabindex * 2) + 1" cc-active cc-activate-on-focus />
      </cc-validatable>
      <select class="input" [(ngModel)]="product.unitType" [tabindex]="(tabindex * 2) + 1" cc-active cc-activate-on-focus>
        <option *ngFor="let ut of unitTypes" [ngValue]="ut.value">{{ ut.name }}</option>
      </select>
    </div>
  </div>
</div>